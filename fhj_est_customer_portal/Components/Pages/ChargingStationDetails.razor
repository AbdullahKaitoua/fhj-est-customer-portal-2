@page "/chargingstationdetails/{StationId}"
@using fhj_est_customer_portal.Services
@inject ChargingStationService ChargingStationService
@inject NavigationManager NavigationManager
@inject AuthenticationStateProvider AuthenticationStateProvider
@using System.Security.Claims
@using fhj_est_customer_portal.Entities
@using Microsoft.AspNetCore.Authorization
@attribute [Authorize]

<h3 class="text-primary mb-4">Charging Station Info</h3>

@if (chargingStation == null)
{
    <p class="text-secondary"><em>Loading...</em></p>
}
else
{
    <div class="card mb-3">
        <div class="card-body">
            <h4 class="card-title">@chargingStation.Name</h4>
            <p class="card-text"><strong>Location:</strong> @chargingStation.Location.Name</p>
            <p class="card-text"><strong>Energy Provider:</strong> @chargingStation.EnergyProvider</p>
            <p class="card-text"><strong>Address:</strong> @chargingStation.Street, @chargingStation.City, @chargingStation.Zip, @chargingStation.Country</p>
            <p class="card-text"><strong>Operator:</strong> @chargingStation.OperatorName</p>
        </div>
    </div>

    <h5 class="text-secondary">Charging Points</h5>
    @if (chargingStation.ChargingPoints.Any())
    {
        <table class="table table-hover">
            <thead class="thead-light">
                <tr>
                    <th>Name</th>
                    <th>Power Type</th>
                    <th>Max Power</th>
                    <th>Plug Types</th>
                    <th>Availability</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var chargingPoint in chargingStation.ChargingPoints)
                {
                    <tr>
                        <td>@chargingPoint.Name</td>
                        <td>@chargingPoint.PowerType</td>
                        <td>@chargingPoint.MaxPower kW</td>
                        <td>@chargingPoint.PlugTypes</td>
                        <td>@(chargingPoint.IsPublic.HasValue && chargingPoint.IsPublic.Value ? "Available" : "Not Available")</td>
                    </tr>
                }
            </tbody>
        </table>
    }
    else
    {
        <p class="text-muted">No charging points available.</p>
    }
}

@code {
    [Parameter]
    public string StationId { get; set; }

    private ChargingStation? chargingStation;

    protected override async Task OnInitializedAsync()
    {
        chargingStation = await ChargingStationService.GetChargingStationById(StationId);
    }
}
